<div class="custom-multiselect-container" (click)="$event.stopPropagation()">
  <div
    class="custom-multiselect-input-wrapper"
    [class.disabled]="isReadonly"
    [class.invalid]="invalidValidator"
  >
    <input
      #multiInputField
      type="text"
      class="custom-multiselect-input"
      [placeholder]="placeholder"
      [value]="getDisplayText()"
      readonly
      (focus)="onInputFocus()"
    />

    <button
      class="custom-multiselect-button"
      (click)="toggleDropdown($event)"
      *ngIf="!isOpen"
      type="button"
    >
      <i class="fa fa-chevron-down"></i>
    </button>

    <button
      class="custom-multiselect-button"
      (click)="toggleDropdown($event)"
      *ngIf="isOpen"
      type="button"
    >
      <i class="fa fa-chevron-up"></i>
    </button>
  </div>

  <div
    #multiselectMenu
    class="custom-multiselect-styling"
    [ngClass]="{
      'multiselect-up': multiselectDirection === 'up',
      'multiselect-down': multiselectDirection === 'down'
    }"
    *ngIf="isOpen"
  >
    <div class="multiselect-filter-container">
      <input
        #inputField
        type="text"
        class="multiselect-filter-input"
        [(ngModel)]="searchQuery"
        (focus)="onInputFocus()"
        (input)="filterOptions()"
      />

      <i class="fa-solid fa-magnifying-glass"></i>
    </div>

    <div
      class="custom-multiselect-item"
      (click)="selectAll()"
      [class.selected]="selectAllOn"
    >
      <input
        type="checkbox"
        class="checkbox-style"
        [checked]="selectedValues.length === options.length"
      />
      <span>Selecionar todos</span>
    </div>

    <div
      class="custom-multiselect-item"
      *ngFor="let option of filteredOptions"
      [class.selected]="selectedValues.includes(option)"
      (click)="selectOption(option)"
    >
      <input
        type="checkbox"
        class="checkbox-style"
        [checked]="isSelected(option)"
      />
      <span>{{ option[labelField] }}</span>
    </div>
  </div>

  <div
    #multiselectMenu
    class="custom-multiselect-styling"
    [ngClass]="{
      'multiselect-up': multiselectDirection === 'up',
      'multiselect-down': multiselectDirection === 'down'
    }"
    *ngIf="isOpen && filteredOptions.length == 0"
  >
    <div class="custom-multiselect-item">
      <p>{{ semResultado }}</p>
    </div>
  </div>
</div>
